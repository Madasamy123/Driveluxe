<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./CSS/model.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
        <style>
            body {
              font-family: Arial, sans-serif;
              margin: 0;
              padding: 0;
              background-color: #f9f9f9;
            }
          
            #car-container {
              display: flex;
              flex-wrap: wrap;
              justify-content: center;
              gap: 20px;
              margin: 20px;
            }
          
            .car-detail {
              background: #fff;
              border: 1px solid #ddd;
              border-radius: 8px;
              box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
              padding: 15px;
              width: 300px;
              transition: transform 0.2s, box-shadow 0.2s;
            }
          
            .car-detail:hover {
              transform: translateY(-5px);
              box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }
          
            .car-title {
              font-size: 20px;
              font-weight: bold;
              color: #333;
              margin-bottom: 10px;
              text-align: center;
            }
          
            .car-detail p {
              margin: 5px 0;
              font-size: 14px;
              color: #555;
            }
          
            .car-detail div img {
              border-radius: 4px;
              border: 1px solid #ddd;
            }
          </style>
          
</head>

<body>

    <div id="carDetailsContainer"></div>

    <div id="car-container">

    </div>

    <div class="main">
        <div class="carmodel_header">
            <h3 id="car_id"></h3>

        </div>
        <div class="model_head">
            <div class="model_types">
                <ul>
                    <a href="">
                        <li>HatchBack</li>
                    </a>
                    <a href="">
                        <li>Sedan</li>
                    </a>
                    <a href="">
                        <li>Suv</li>
                    </a>
                    <a href="">
                        <li>Electric</li>
                    </a>
                    <a href="">
                        <li>All</li>
                    </a>

                </ul>

            </div> 

            <div class="car_img">
                <h5>Tata Harrier</h5>
                <a href=""><img src="./Assests/images/tata_harrier_suv32.webp" alt=""></a>

                <div class="arrow_icon">
                    <a href=""><i class="fa-solid fa-angle-left"></i></a>
                    <a href=""><i class="fa-solid fa-angle-right"></i></a>

                </div>

            </div>

            <div class="carPoint_head">
                <div>
                    <p id="car-id"></p>
                    <p>Ex-Showroom Price: &#8377;1300000 Laks</p>
                    <p>Mileage: 18-25kmpl</p>
                </div>
                <div>
                    <p>Engine: 1197cc</p>
                    <p>Fuel Type: Petrol</p>

                </div>
            </div>

        </div>

    </div>


    <script type="module">
        const urlParams = new URLSearchParams(window.location.search);
        let carId = urlParams.get('carId');
        // document.getElementById('car-id').textContent = `Car ID: ${carId}`;
        // document.getElementById('car_id').textContent = `${carId} CARS`;




        console.log(carId);














        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

        // Firebase Config - Replace with your Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyC0tw4_CFl84kb5i4DeuBkKf0gA7gS3mF4",
            authDomain: "login-page1234.firebaseapp.com",
            projectId: "login-page1234",
            storageBucket: "login-page1234.appspot.com",
            messagingSenderId: "471482088238",
            appId: "1:471482088238:web:eb3db8a185185e54e118bf"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        console.log(app);
        console.log(db);


        // Fetch and Display All Documents in "cardetails" Collection
        async function fetchAllCarDetails() {
            try {
                const querySnapshot = await getDocs(collection(db, "cardetails"));
            
                const carDetailsContainer = document.getElementById("carDetailsContainer");
                console.log(querySnapshot);

               

                const uniqueCars = [];

                console.log(`carid ${querySnapshot.empty}`);
                if (!querySnapshot.empty) {

                    console.log("true");
                    
                    querySnapshot.forEach((doc) => {
                        const data = doc.data(); // Get the document data
                        

                        
            // console.log("Data in JSON format:", JSON.stringify(data, null, 2));
            const car = JSON.stringify(data, null, 2);
            let jsonobj = JSON.parse(car)[carId];
            // console.log(JSON.parse(car)['Honda']);

            if (jsonobj != undefined && jsonobj != null) {
                    uniqueCars.push(jsonobj); // Add unique object
            }

                        // renderCarDetails(data, carDetailsContainer);
                    });

                    console.log(uniqueCars);
                    console.log(uniqueCars[0]);


                    const flattenedData = flattenCarData(uniqueCars[0]);

                    console.log(flattenedData);
                    

                    const container = document.getElementById("car-container");

                    for (const carName in flattenedData) {
    const car = flattenedData[carName];

    const carDiv = document.createElement("div");
    carDiv.classList.add("car-detail");
    carDiv.innerHTML = `
        <h3 class="car-title">${car.Title}</h3>
        <p><strong>Price:</strong> ${car.Price}</p>
        <p><strong>Mileage:</strong> ${car.Mileage || "N/A"}</p>
        <p><strong>Engine:</strong> ${car.Engine}</p>
        <p><strong>Fuel Type:</strong> ${car["Fuel Type"]}</p>
        <p><strong>Transmission:</strong> ${car.Transimission}</p>
        <p><strong>Seating Capacity:</strong> ${car["Seating Capacity"]}</p>
        <p><strong>Safety:</strong> ${car.Safety}</p>
        <p><strong>Description:</strong> ${car.description}</p>
        <div>
            <img src="${car.img1}" alt="${car.Title}" style="width:100px; margin-right:10px;">
            <img src="${car.img2}" alt="${car.Title}" style="width:100px; margin-right:10px;">
        </div>
    `;

    container.appendChild(carDiv);
}

                } else {
                    carDetailsContainer.innerHTML = "<p>No car details available.</p>";
                }
            } catch (error) {
                console.error("Error fetching car details:", error);
            }
        }

        function flattenCarData(data) {
    const flattenedData = {};
    for (const category in data) {
        for (const carName in data[category]) {
            flattenedData[carName] = data[category][carName];
        }
    }
    return flattenedData;
}

        // Render Nested Car Details
        function renderCarDetails(data, container) {

            const uniqueCars = [];
            // console.log("Data in JSON format:", JSON.stringify(data, null, 2));
            const car = JSON.stringify(data, null, 2);
            let jsonobj = JSON.parse(car)['Honda'];
            // console.log(JSON.parse(car)['Honda']);

            if (jsonobj != undefined && jsonobj != null) {
                    uniqueCars.push(jsonobj); // Add unique object
            }

            console.log(uniqueCars);
            
            

            for (const category in data.carId) {
                const categoryDiv = document.createElement("div");
                categoryDiv.classList.add("car-category");
                categoryDiv.innerHTML = `<h2>${category}</h2>`;

                const cars = data.carId[category];

               
                
                for (const carName in cars) {
                    const car = cars[carName];
                    const carDiv = document.createElement("div");
                    carDiv.classList.add("car-detail");
                    carDiv.innerHTML = `
            <h3 class="car-title">${car.Title}</h3>
            <p>Price: ${car.Price}</p>
            <p>Mileage: ${car.Mileage || "N/A"}</p>
            <p>Engine: ${car.Engine}</p>
            <p>Fuel Type: ${car["Fuel Type"]}</p>
            <p>Transmission: ${car.Transimission}</p>
            <p>Seating Capacity: ${car["Seating Capacity"]}</p>
            <p>Safety: ${car.Safety}</p>
            <p>Description: ${car.description}</p>
            <div>
              <img src="${car.img1}" alt="${car.Title}" style="width:150px; margin-right:10px;">
              <img src="${car.img2}" alt="${car.Title}" style="width:150px; margin-right:10px;">
            </div>
          `;
                    categoryDiv.appendChild(carDiv);
                }

                container.appendChild(categoryDiv);
            }
        }

        // Call the fetchAllCarDetails function on window load
        window.onload = fetchAllCarDetails;






    </script>

</body>

</html>